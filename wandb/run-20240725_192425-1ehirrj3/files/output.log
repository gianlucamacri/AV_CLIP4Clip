07/25/2024 19:24:27 - INFO -   loading archive file /home/gmacri/tesiMagistrale/AV_CLIP4Clip/modules/cross-base
07/25/2024 19:24:27 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}
07/25/2024 19:24:27 - INFO -   Weight doesn't exsits. /home/gmacri/tesiMagistrale/AV_CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
07/25/2024 19:24:27 - WARNING -   Stage-One:True, Stage-Two:False
07/25/2024 19:24:27 - WARNING -   Test retrieval by loose type.
07/25/2024 19:24:27 - WARNING -   	 embed_dim: 512
07/25/2024 19:24:27 - WARNING -   	 image_resolution: 224
07/25/2024 19:24:27 - WARNING -   	 vision_layers: 12
07/25/2024 19:24:27 - WARNING -   	 vision_width: 768
07/25/2024 19:24:27 - WARNING -   	 vision_patch_size: 32
07/25/2024 19:24:27 - WARNING -   	 context_length: 77
07/25/2024 19:24:27 - WARNING -   	 vocab_size: 49408
07/25/2024 19:24:27 - WARNING -   	 transformer_width: 512
07/25/2024 19:24:27 - WARNING -   	 transformer_heads: 8
07/25/2024 19:24:27 - WARNING -   	 transformer_layers: 12
07/25/2024 19:24:27 - WARNING -   		 linear_patch: 2d
07/25/2024 19:24:27 - WARNING -   	 cut_top_layer: 0
07/25/2024 19:24:28 - WARNING -   	 sim_header: meanP
07/25/2024 19:24:31 - INFO -   --------------------
07/25/2024 19:24:31 - INFO -   Weights from pretrained model not used in CLIP4Clip:
   clip.input_resolution
   clip.context_length
   clip.vocab_size
07/25/2024 19:24:32 - INFO -   updating metadata video filename paths to match the actual location, to prevent this behavior set the updateVideoFilenames to false
07/25/2024 19:24:32 - INFO -   updating metadata video filename paths to match the actual location, to prevent this behavior set the updateVideoFilenames to false
07/25/2024 19:24:32 - INFO -   ***** Running test *****
07/25/2024 19:24:32 - INFO -     Num examples = 24
07/25/2024 19:24:32 - INFO -     Batch size = 16
07/25/2024 19:24:32 - INFO -     Num steps = 2
07/25/2024 19:24:32 - INFO -   ***** Running val *****
07/25/2024 19:24:32 - INFO -     Num examples = 6
07/25/2024 19:24:32 - INFO -   updating metadata video filename paths to match the actual location, to prevent this behavior set the updateVideoFilenames to false
07/25/2024 19:24:32 - INFO -   0 (0.0 %) will remain unsued for each epoch due to drop last set to true for the dataloader
07/25/2024 19:24:32 - INFO -   ***** Running training *****
07/25/2024 19:24:32 - INFO -     Num examples = 90
07/25/2024 19:24:32 - INFO -     Batch size = 30
07/25/2024 19:24:32 - INFO -     Num steps = 36





100%|███████████████████████████████████████████| 6/6 [00:36<00:00,  6.16s/it]
07/25/2024 19:25:09 - INFO -   Epoch 1/6 Finished, Train Loss: 0.402569
07/25/2024 19:25:10 - INFO -   Model saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.0
07/25/2024 19:25:10 - INFO -   Optimizer saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_opt.bin.0
07/25/2024 19:25:10 - INFO -   Eval on val dataset

  0%|                                                   | 0/1 [00:00<?, ?it/s]07/25/2024 19:25:13 - INFO -   retrieval of video 16 took 2.2782169779529795
0/1
07/25/2024 19:25:13 - INFO -   computation took 0.04762097308412194
100%|███████████████████████████████████████████| 1/1 [00:02<00:00,  2.33s/it]
07/25/2024 19:25:14 - INFO -   sim matrix size: 6, 6
07/25/2024 19:25:14 - INFO -   	 Length-T: 6, Length-V:6
07/25/2024 19:25:14 - INFO -   Similarity loss: 1.5
07/25/2024 19:25:14 - INFO -   Text-to-Video:
07/25/2024 19:25:14 - INFO -   	>>>  R@1: 83.3 - R@5: 100.0 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.3
07/25/2024 19:25:14 - INFO -   Video-to-Text:
07/25/2024 19:25:14 - INFO -   	>>>  V2T$R@1: 83.3 - V2T$R@5: 83.3 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.8
07/25/2024 19:25:14 - INFO -   The best model according to loss strategy is: ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.0, its metric is: 1.5477





100%|███████████████████████████████████████████| 6/6 [00:36<00:00,  6.10s/it]
07/25/2024 19:25:50 - INFO -   Epoch 2/6 Finished, Train Loss: 0.097299
07/25/2024 19:25:51 - INFO -   Model saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.1
07/25/2024 19:25:51 - INFO -   Optimizer saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_opt.bin.1
07/25/2024 19:25:51 - INFO -   Eval on val dataset
  0%|                                                   | 0/1 [00:00<?, ?it/s]07/25/2024 19:25:54 - INFO -   retrieval of video 16 took 2.2971659239847213
07/25/2024 19:25:54 - INFO -   computation took 0.049033470917493105
100%|███████████████████████████████████████████| 1/1 [00:02<00:00,  2.35s/it]
07/25/2024 19:25:54 - INFO -   sim matrix size: 6, 6
07/25/2024 19:25:54 - INFO -   	 Length-T: 6, Length-V:6
07/25/2024 19:25:54 - INFO -   Similarity loss: 1.2
07/25/2024 19:25:54 - INFO -   Text-to-Video:
07/25/2024 19:25:54 - INFO -   	>>>  R@1: 83.3 - R@5: 100.0 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.3
07/25/2024 19:25:54 - INFO -   Video-to-Text:
07/25/2024 19:25:54 - INFO -   	>>>  V2T$R@1: 83.3 - V2T$R@5: 83.3 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.8
07/25/2024 19:25:54 - INFO -   The best model according to loss strategy is: ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.1, its metric is: 1.2248





100%|███████████████████████████████████████████| 6/6 [00:36<00:00,  6.03s/it]
07/25/2024 19:26:30 - INFO -   Epoch 3/6 Finished, Train Loss: 0.030399
07/25/2024 19:26:31 - INFO -   Model saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.2
07/25/2024 19:26:31 - INFO -   Optimizer saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_opt.bin.2
07/25/2024 19:26:31 - INFO -   Eval on val dataset
  0%|                                                   | 0/1 [00:00<?, ?it/s]07/25/2024 19:26:33 - INFO -   retrieval of video 16 took 2.3092397860018536
07/25/2024 19:26:33 - INFO -   computation took 0.048203299986198545
100%|███████████████████████████████████████████| 1/1 [00:02<00:00,  2.36s/it]
07/25/2024 19:26:33 - INFO -   sim matrix size: 6, 6
07/25/2024 19:26:33 - INFO -   	 Length-T: 6, Length-V:6
07/25/2024 19:26:33 - INFO -   Similarity loss: 1.0
07/25/2024 19:26:33 - INFO -   Text-to-Video:
07/25/2024 19:26:33 - INFO -   	>>>  R@1: 83.3 - R@5: 100.0 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.3
07/25/2024 19:26:33 - INFO -   Video-to-Text:
07/25/2024 19:26:33 - INFO -   	>>>  V2T$R@1: 83.3 - V2T$R@5: 100.0 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.7
07/25/2024 19:26:33 - INFO -   The best model according to loss strategy is: ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.2, its metric is: 0.9929





100%|███████████████████████████████████████████| 6/6 [00:36<00:00,  6.10s/it]
07/25/2024 19:27:10 - INFO -   Epoch 4/6 Finished, Train Loss: 0.032148
07/25/2024 19:27:11 - INFO -   Model saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.3
07/25/2024 19:27:11 - INFO -   Optimizer saved to ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_opt.bin.3
07/25/2024 19:27:11 - INFO -   Eval on val dataset
07/25/2024 19:27:13 - INFO -   	 Length-T: 6, Length-V:6| 0/1 [00:00<?, ?it/s]07/25/2024 19:27:13 - INFO -   retrieval of video 16 took 2.3198169969255105
07/25/2024 19:27:13 - INFO -   computation took 0.04863039206247777
100%|███████████████████████████████████████████| 1/1 [00:02<00:00,  2.37s/it]
07/25/2024 19:27:13 - INFO -   sim matrix size: 6, 6
07/25/2024 19:27:13 - INFO -   	 Length-T: 6, Length-V:6| 0/1 [00:00<?, ?it/s]07/25/2024 19:27:13 - INFO -   retrieval of video 16 took 2.3198169969255105
07/25/2024 19:27:13 - INFO -   Similarity loss: 1.0
07/25/2024 19:27:13 - INFO -   Text-to-Video:
07/25/2024 19:27:13 - INFO -   	>>>  R@1: 83.3 - R@5: 100.0 - R@10: 100.0 - Median R: 1.0 - Mean R: 1.3
07/25/2024 19:27:13 - INFO -   Video-to-Text:
07/25/2024 19:27:13 - INFO -   	>>>  V2T$R@1: 83.3 - V2T$R@5: 100.0 - V2T$R@10: 100.0 - V2T$Median R: 1.0 - V2T$Mean R: 1.5
07/25/2024 19:27:13 - INFO -   The best model according to loss strategy is: ckpts/av_retreival_lr0.0002_e6_b30_48fps_loss_42_1721928264_test/pytorch_model.bin.2, its metric is: 0.9929
 17%|███████▏                                   | 1/6 [00:05<00:26,  5.31s/it]
 33%|██████████████▎                            | 2/6 [00:11<00:24,  6.04s/it]
 50%|█████████████████████▌                     | 3/6 [00:19<00:20,  6.83s/it]
 67%|████████████████████████████▋              | 4/6 [00:24<00:12,  6.06s/it]
 83%|███████████████████████████████████▊       | 5/6 [00:30<00:06,  6.08s/it]
100%|███████████████████████████████████████████| 6/6 [00:36<00:00,  6.05s/it]
07/25/2024 19:27:53 - INFO -   Text-to-Video:███| 6/6 [00:36<00:00,  6.05s/it]
07/25/2024 19:27:53 - INFO -   Text-to-Video:███| 6/6 [00:36<00:00,  6.05s/it]
07/25/2024 19:27:53 - INFO -   Text-to-Video:███| 6/6 [00:36<00:00,  6.05s/it]
07/25/2024 19:27:53 - INFO -   Text-to-Video:███| 6/6 [00:36<00:00,  6.05s/it]
07/25/2024 19:27:53 - INFO -   Text-to-Video:███| 6/6 [00:36<00:00,  6.05s/it]
 83%|███████████████████████████████████▊       | 5/6 [00:30<00:05,  5.94s/it]
100%|███████████████████████████████████████████| 6/6 [00:36<00:00,  6.06s/it]
100%|███████████████████████████████████████████| 6/6 [00:36<00:00,  6.06s/it]07/25/2024 19:28:33 - INFO -   retrieval of video 16 took 2.31450019904878
07/25/2024 19:28:33 - WARNING -   	 vision_patch_size: 32/gmacri/tesiMagistrale/AV_CLIP4Clip/modules/cross-basetrieval of video 16 took 2.31450019904878
   clip.input_resolutionRNING -   	 vision_patch_size: 32/gmacri/tesiMagistrale/AV_CLIP4Clip/modules/cross-basetrieval of video 16 took 2.31450019904878

0/2

07/25/2024 19:28:45 - INFO -   Text-to-Video:tch_size: 32/gmacri/tesiMagistrale/AV_CLIP4Clip/modules/cross-basetrieval of video 16 took 2.31450019904878
07/25/2024 19:28:45 - INFO -   Text-to-Video:tch_size: 32/gmacri/tesiMagistrale/AV_CLIP4Clip/modules/cross-basetrieval of video 16 took 2.31450019904878